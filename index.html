<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>연애 성향 검사</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Malgun Gothic", "맑은 고딕", sans-serif;
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            word-break: keep-all;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .section-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .question {
            margin-bottom: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 3px solid #667eea;
        }
        
        .question-number {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 8px;
            font-size: 0.9em;
        }
        
        .question-text {
            margin-bottom: 12px;
            font-size: 1.05em;
        }
        
        .scale-options {
            display: flex;
            justify-content: space-between;
            gap: 8px;
        }
        
        .scale-option {
            flex: 1;
            text-align: center;
        }
        
        .scale-option input[type="radio"] {
            display: none;
        }
        
        .scale-option label {
            display: block;
            padding: 10px 5px;
            background: #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85em;
        }
        
        .scale-option input[type="radio"]:checked + label {
            background: #667eea;
            color: white;
            transform: scale(1.05);
        }
        
        .scale-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 0.75em;
            color: #6c757d;
        }
        
        .demo-group {
            margin-bottom: 20px;
        }
        
        .demo-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #495057;
        }
        
        .demo-group select,
        .demo-group input[type="text"],
        .demo-group input[type="email"],
        .demo-group input[type="tel"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        
        .demo-group select:focus,
        .demo-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .radio-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .radio-item {
            display: flex;
            align-items: center;
        }
        
        .radio-item input[type="radio"] {
            margin-right: 5px;
        }
        
        .checkbox-group {
            margin: 15px 0;
        }
        
        .checkbox-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 10px;
        }
        
        .checkbox-item input[type="checkbox"] {
            margin-right: 10px;
            margin-top: 3px;
        }
        
        .submit-section {
            text-align: center;
            margin-top: 40px;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 1.2em;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(102, 126, 234, 0.5);
        }
        
        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* 동의 섹션 스타일 */
        .consent-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #e9ecef;
        }
        
        .consent-title {
            font-weight: bold;
            margin-bottom: 15px;
            color: #495057;
        }
        
        .consent-content {
            font-size: 0.9em;
            line-height: 1.6;
            color: #6c757d;
            margin-bottom: 15px;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 5px;
        }
        
        /* 결과 섹션 스타일 */
        .result-section {
            display: none;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-top: 30px;
        }
        
        .result-header {
            text-align: center;
            padding-bottom: 30px;
            border-bottom: 2px solid #f0f0f0;
            margin-bottom: 30px;
        }
        
        .result-type {
            font-size: 2.5em;
            margin: 20px 0;
            font-weight: bold;
        }
        
        .type-description {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            line-height: 1.8;
            text-align: left;
        }
        
        .scale-results {
            margin-top: 40px;
        }
        
        .scale-result {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #e0e0e0;
            word-break: keep-all;
        }
        
        .scale-result.caution {
            border-left-color: #ff6b6b;
            background: #fff5f5;
        }
        
        .scale-name {
            font-weight: bold;
            color: #333366;
        }
        
        .caution-icon {
            color: #ff6b6b;
            font-size: 1.2em;
        }
        
        .type-danger { color: #dc3545; }
        .type-warning { color: #fd7e14; }
        .type-caution { color: #ffc107; }
        .type-safe { color: #28a745; }
        
        .email-notice {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            text-align: center;
        }
        
        hr {
            border: none;
            border-top: 1px solid #e0e0e0;
            margin: 25px 0;
        }
        
        .error {
            color: #dc3545;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        .optional-notice {
            font-size: 0.85em;
            color: #6c757d;
            margin-top: 5px;
        }
        
        @media (max-width: 600px) {
            .scale-options {
                gap: 5px;
            }
            
            .scale-option label {
                padding: 8px 3px;
                font-size: 0.8em;
            }
            
            .radio-group {
                flex-direction: column;
            }
            
            .result-section {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>💝 연애 성향 검사</h1>
            <p>건강한 연애를 위한 첫걸음</p>
        </div>
        
        <form id="testForm">
            <!-- 개인정보 수집 동의 섹션 -->
            <div class="section">
                <h2 class="section-title">개인정보 수집 및 이용 동의</h2>
                <div class="consent-box">
                    <div class="consent-title">개인정보 수집·이용 동의서</div>
                    <div class="consent-content">
                        <p><strong>1. 수집하는 개인정보 항목</strong></p>
                        <p>- 필수항목: 이름, 성별, 연령대, 검사 응답 내용</p>
                        <p>- 선택항목: 이메일 주소, 전화번호</p>
                        <br>
                        <p><strong>2. 개인정보의 수집 및 이용목적</strong></p>
                        <p>- 연애 성향 검사 결과 제공</p>
                        <p>- 맞춤형 상담 및 조언 제공</p>
                        <p>- 경품 추첨 및 지급 (선택 시)</p>
                        <br>
                        <p><strong>3. 개인정보의 보유 및 이용기간</strong></p>
                        <p>- 검사 결과 제공 후 1년간 보관</p>
                        <p>- 이용자의 삭제 요청 시 즉시 파기</p>
                        <br>
                        <p><strong>4. 동의 거부권 및 불이익</strong></p>
                        <p>- 개인정보 수집 동의를 거부할 권리가 있습니다.</p>
                        <p>- 필수항목 동의 거부 시 검사 진행이 불가능합니다.</p>
                        <p>- 선택항목 동의 거부 시 해당 서비스 이용이 제한됩니다.</p>
                    </div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="consent1" name="consent1" required>
                            <label for="consent1">[필수] 개인정보 수집 및 이용에 동의합니다.</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="consent2" name="consent2">
                            <label for="consent2">[선택] 검사 결과 이메일 수신에 동의합니다.</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="consent3" name="consent3">
                            <label for="consent3">[선택] 경품 추첨을 위한 전화번호 수집에 동의합니다.</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 기본 정보 섹션 -->
            <div class="section">
                <h2 class="section-title">기본 정보</h2>
                
                <div class="demo-group" id="group_name">
                    <label for="name">이름 *</label>
                    <input type="text" id="name" name="name" required>
                </div>
                
                <div class="demo-group" id="group_gender">
                    <label>성별 *</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="gender1" name="gender" value="남성" required>
                            <label for="gender1">남성</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="gender2" name="gender" value="여성" required>
                            <label for="gender2">여성</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="gender3" name="gender" value="기타" required>
                            <label for="gender3">기타</label>
                        </div>
                    </div>
                </div>
                
                <div class="demo-group" id="group_age">
                    <label for="age">연령대 *</label>
                    <select id="age" name="age" required>
                        <option value="">선택하세요</option>
                        <option value="10대">10대</option>
                        <option value="20대">20대</option>
                        <option value="30대">30대</option>
                        <option value="40대">40대</option>
                        <option value="50대 이상">50대 이상</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_marriage">
                    <label for="marriage">결혼상태 *</label>
                    <select id="marriage" name="marriage" required>
                        <option value="">선택하세요</option>
                        <option value="미혼">미혼</option>
                        <option value="기혼">기혼</option>
                        <option value="이혼">이혼</option>
                        <option value="사별">사별</option>
                        <option value="기타">기타</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_education">
                    <label for="education">최종학력 *</label>
                    <select id="education" name="education" required>
                        <option value="">선택하세요</option>
                        <option value="고졸 이하">고졸 이하</option>
                        <option value="대학 재학">대학 재학</option>
                        <option value="대학 졸업">대학 졸업</option>
                        <option value="대학원 이상">대학원 이상</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_job">
                    <label for="job">직업 *</label>
                    <select id="job" name="job" required>
                        <option value="">선택하세요</option>
                        <option value="학생">학생</option>
                        <option value="직장인">직장인</option>
                        <option value="자영업/프리랜서">자영업/프리랜서</option>
                        <option value="전문직">전문직</option>
                        <option value="주부">주부</option>
                        <option value="무직">무직</option>
                        <option value="기타">기타</option>
                    </select>
                </div>
            </div>
            
            <!-- 연애 경험 섹션 -->
            <div class="section">
                <h2 class="section-title">연애 경험</h2>
                
                <div class="demo-group" id="group_loveFreq">
                    <label for="loveFreq">연애경험 빈도 *</label>
                    <select id="loveFreq" name="loveFreq" required>
                        <option value="">선택하세요</option>
                        <option value="없음">없음</option>
                        <option value="1-2회">1-2회</option>
                        <option value="3-5회">3-5회</option>
                        <option value="6-9회">6-9회</option>
                        <option value="10회 이상">10회 이상</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_loveDuration">
                    <label for="loveDuration">평균 연애관계 기간 *</label>
                    <select id="loveDuration" name="loveDuration" required>
                        <option value="">선택하세요</option>
                        <option value="없음">없음</option>
                        <option value="3개월 미만">3개월 미만</option>
                        <option value="3-6개월">3-6개월</option>
                        <option value="6개월-1년">6개월-1년</option>
                        <option value="1-2년">1-2년</option>
                        <option value="2년 이상">2년 이상</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_currentStatus">
                    <label for="currentStatus">현재 연애 상태 *</label>
                    <select id="currentStatus" name="currentStatus" required>
                        <option value="">선택하세요</option>
                        <option value="연애 중">연애 중</option>
                        <option value="썸타는 중">썸타는 중</option>
                        <option value="짝사랑 중">짝사랑 중</option>
                        <option value="이별 후 회복 중">이별 후 회복 중</option>
                        <option value="연애하지 않음">연애하지 않음</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_meetingMethod">
                    <label for="meetingMethod">주로 연인을 만나는 방식 *</label>
                    <select id="meetingMethod" name="meetingMethod" required>
                        <option value="">선택하세요</option>
                        <option value="일상생활(학교/직장)">일상생활(학교/직장)</option>
                        <option value="소개팅">소개팅</option>
                        <option value="데이팅앱">데이팅앱</option>
                        <option value="동호회/모임">동호회/모임</option>
                        <option value="기타">기타</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_datingApp">
                    <label>데이팅 앱 사용경험 *</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="dating1" name="datingApp" value="사용 중" required>
                            <label for="dating1">사용 중</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="dating2" name="datingApp" value="사용한 적 있음" required>
                            <label for="dating2">사용한 적 있음</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="dating3" name="datingApp" value="사용한 적 없음" required>
                            <label for="dating3">사용한 적 없음</label>
                        </div>
                    </div>
                </div>
                
                <div class="demo-group" id="group_socialMediaCheck">
                    <label for="socialMediaCheck">소셜미디어를 통해 연인의 활동을 확인하는 빈도 *</label>
                    <select id="socialMediaCheck" name="socialMediaCheck" required>
                        <option value="">선택하세요</option>
                        <option value="전혀 확인하지 않음">전혀 확인하지 않음</option>
                        <option value="주 1-2회">주 1-2회</option>
                        <option value="매일 확인함">매일 확인함</option>
                        <option value="하루에 1-2회 확인함">하루에 1-2회 확인함</option>
                        <option value="하루에 여러 번 확인함">하루에 여러 번 확인함</option>
                        <option value="해당 없음">해당 없음(소셜미디어 사용 안 함)</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_contactFreq">
                    <label for="contactFreq">연인과의 연락 빈도 *</label>
                    <select id="contactFreq" name="contactFreq" required>
                        <option value="">선택하세요</option>
                        <option value="하루에 여러 번">하루에 여러 번</option>
                        <option value="하루에 한 번">하루에 한 번</option>
                        <option value="2-3일에 한 번">2-3일에 한 번</option>
                        <option value="일주일에 한 번">일주일에 한 번</option>
                        <option value="그보다 드물게">그보다 드물게</option>
                        <option value="현재 연인 없음">현재 연인 없음</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_replyWait">
                    <label for="replyWait">연인의 답장을 언제까지 기다릴 수 있나요? *</label>
                    <select id="replyWait" name="replyWait" required>
                        <option value="">선택하세요</option>
                        <option value="즉시">즉시</option>
                        <option value="1시간">1시간</option>
                        <option value="일과후">일과후</option>
                        <option value="취침전">취침전</option>
                        <option value="2일">2일</option>
                        <option value="1주일">1주일</option>
                        <option value="상관없음">상관없음</option>
                    </select>
                </div>
            </div>
            
            <!-- 핵심 검사 문항 섹션 -->
            <div class="section">
                <h2 class="section-title">검사 문항</h2>
                <p style="margin-bottom: 20px; color: #6c757d;">각 문항을 읽고 자신과 가장 가까운 답변을 선택해주세요.</p>
                
                <div id="questionsContainer">
                    <!-- 문항들이 JavaScript로 동적 생성됩니다 -->
                </div>
            </div>
            
            <!-- 심리 스트레스 섹션 -->
            <div class="section">
                <h2 class="section-title">심리 스트레스</h2>
                
                <div class="demo-group" id="group_stress">
                    <label for="stress">최근 1개월간 스트레스 빈도 *</label>
                    <select id="stress" name="stress" required>
                        <option value="">선택하세요</option>
                        <option value="거의 없음">거의 없음</option>
                        <option value="가끔">가끔</option>
                        <option value="자주">자주</option>
                        <option value="매우 자주">매우 자주</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_anxiety">
                    <label for="anxiety">최근 1개월간 불안 빈도 *</label>
                    <select id="anxiety" name="anxiety" required>
                        <option value="">선택하세요</option>
                        <option value="거의 없음">거의 없음</option>
                        <option value="가끔">가끔</option>
                        <option value="자주">자주</option>
                        <option value="매우 자주">매우 자주</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_depression">
                    <label for="depression">최근 1개월간 우울감 빈도 *</label>
                    <select id="depression" name="depression" required>
                        <option value="">선택하세요</option>
                        <option value="거의 없음">거의 없음</option>
                        <option value="가끔">가끔</option>
                        <option value="자주">자주</option>
                        <option value="매우 자주">매우 자주</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_mentalDiagnosis">
                    <label for="mentalDiagnosis">정신 건강 관련 진단을 받은 적이 있으십니까? *</label>
                    <select id="mentalDiagnosis" name="mentalDiagnosis" required>
                        <option value="">선택하세요</option>
                        <option value="없음">없음</option>
                        <option value="있음">있음</option>
                        <option value="응답하고 싶지 않음">응답하고 싶지 않음</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_counseling">
                    <label for="counseling">상담을 받은 적이 있으십니까? *</label>
                    <select id="counseling" name="counseling" required>
                        <option value="">선택하세요</option>
                        <option value="있음">있음</option>
                        <option value="없음">없음</option>
                        <option value="응답하고 싶지 않음">응답하고 싶지 않음</option>
                    </select>
                </div>
                
                <div class="demo-group" id="group_psychiatry">
                    <label for="psychiatry">정신건강의학과 진료를 받은 적이 있으십니까? *</label>
                    <select id="psychiatry" name="psychiatry" required>
                        <option value="">선택하세요</option>
                        <option value="있음">있음</option>
                        <option value="없음">없음</option>
                        <option value="응답하고 싶지 않음">응답하고 싶지 않음</option>
                    </select>
                </div>
                
                <!-- 애착 관련 문항들 -->
                <div id="attachmentContainer">
                    <!-- 애착 문항들이 JavaScript로 동적 생성됩니다 -->
                </div>
                
                <div class="demo-group" id="group_breakupReason">
                    <label for="breakupReason">마지막 연애에서 연인과 무엇 때문에 헤어졌나요? *</label>
                    <select id="breakupReason" name="breakupReason" required>
                        <option value="">선택하세요</option>
                        <option value="성격차이">성격차이</option>
                        <option value="의사소통 문제">의사소통 문제</option>
                        <option value="시간과 관심 부족">시간과 관심 부족</option>
                        <option value="신뢰문제">신뢰문제</option>
                        <option value="미래에 대한 목표차이">미래에 대한 목표차이</option>
                        <option value="가족문제">가족문제</option>
                        <option value="권태기">권태기</option>
                        <option value="경제적 문제">경제적 문제</option>
                        <option value="외부 요인">외부 요인(장거리 연애 등)</option>
                        <option value="자기 성장과 변화">자기 성장과 변화</option>
                        <option value="과도한 집착과 통제">과도한 집착과 통제</option>
                        <option value="지나친 의심과 질투">지나친 의심과 질투</option>
                        <option value="상대방의 요청을 존중하지 않을 때">상대방의 요청을 존중하지 않을 때</option>
                        <option value="해당없음">해당없음(연애 경험 없음)</option>
                    </select>
                </div>
            </div>
            
            <!-- 연락처 섹션 -->
            <div class="section">
                <h2 class="section-title">결과 수신 및 경품</h2>
                
                <div class="demo-group" id="group_email">
                    <label for="email">이메일 주소</label>
                    <input type="email" id="email" name="email" placeholder="example@email.com">
                    <p class="optional-notice">상세 분석과 맞춤형 조언을 이메일로 받으실 수 있습니다. (선택)</p>
                </div>
                
                <div class="demo-group" id="group_phone">
                    <label for="phone">전화번호</label>
                    <input type="tel" id="phone" name="phone" placeholder="010-0000-0000">
                    <p class="optional-notice">경품 추첨에 참여하시려면 전화번호를 입력해주세요. (선택)</p>
                    <p class="optional-notice">* 추첨을 통해 소정의 상품을 드립니다.</p>
                </div>
            </div>
            
            <div class="submit-section">
                <button type="submit" class="submit-btn" id="submitBtn">결과 확인하기</button>
            </div>
        </form>
        
        <!-- 결과 섹션 -->
        <div class="result-section" id="resultSection">
            <div class="result-header">
                <h2>📋 연애 성향 검사 간단 결과</h2>
            </div>
            
            <div style="padding: 20px; background: #f9f9f9; border: 1px solid #ccc; border-radius: 10px;">
                <p><strong id="resultName"></strong>님의 검사 결과는 <span class="highlight" id="resultType" style="font-weight: bold; color: #cc0000;"></span>입니다.</p>
                
                <div class="type-description" id="typeDescription"></div>
                
                <hr>
                <h3 style="color: #333366;">📊 하위 척도 요약</h3>
                <div id="scaleResults"></div>
                
                <hr>
                <div class="email-notice">
                    <p>⚠️ 상세 해석과 맞춤 조언은 이메일 입력자에 한해 개별 발송되었습니다.</p>
                    <p>결과 리포트를 다시 받고 싶으시면 검사 마지막 페이지에서 이메일을 입력해주세요.</p>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // 검사 문항 데이터
        const questions = [
            { id: 1, scale: 'attachment', text: '하루에도 여러 번 그 사람의 SNS를 몰래 확인하게 된다.' },
            { id: 2, scale: 'control', text: '연인이 나와 상의 없이 개인 일정을 세우면 기분이 상한다.' },
            { id: 3, scale: 'rejection', text: '고백을 거절당한 경험이 오래도록 마음에 남아 있다.' },
            { id: 4, scale: 'selfcenter', text: '나만큼 좋아하지 않으면 상대방이 진심을 다하지 않는다고 생각한다.' },
            { id: 5, scale: 'belief', text: '좋아하는 사람에게 하루에 몇 번씩 연락하는 건 당연한 행동이라고 생각한다.' },
            { id: 6, scale: 'attachment', text: '상대가 바쁘다고 해도 내 연락에는 바로 답해줬으면 한다.' },
            { id: 7, scale: 'control', text: '상대가 누구와 어디 있는지를 계속 알고 싶어진다.' },
            { id: 8, scale: 'rejection', text: '단순한 \'선의\'나 \'호의\'도 나를 좋아하는 신호로 착각한 적 있다.' },
            { id: 9, scale: 'selfcenter', text: '연애는 나의 진심을 먼저 보여주는 사람이 더 유리하다.' },
            { id: 10, scale: 'belief', text: '상대가 부담스럽다고 해도 내 진심이면 받아들여야 한다고 믿는다.' },
            { id: 11, scale: 'decision', text: '연락이 차단되면 다른 방법(다른 번호, 계정, 통장입금 등)으로라도 연락을 시도한다.' },
            { id: 12, scale: 'attachment', text: '상대방의 일거수일투족을 다 알고 싶어진다.' },
            { id: 13, scale: 'control', text: '연인이 다른 이성과 대화하는 것을 보면 불안하고 화가 난다.' },
            { id: 14, scale: 'rejection', text: '한 번 거절당하면 그 사람에 대한 원망이 생긴다.' },
            { id: 15, scale: 'selfcenter', text: '내가 좋아하면 상대도 나를 좋아해야 한다고 생각한다.' },
            { id: 16, scale: 'check', text: '이 문항은 \'전혀 그렇지 않다\'를 선택해주세요.' },
            { id: 17, scale: 'belief', text: '연락을 많이 하는 건 관심인데 불편해하는 것은 핑계일 뿐이다.' },
            { id: 18, scale: 'attachment', text: '하루라도 연락이 없으면 불안해진다.' },
            { id: 19, scale: 'control', text: '연인의 휴대폰을 보고 싶은 충동을 느낀다.' },
            { id: 20, scale: 'rejection', text: '내 마음을 몰라주면 일부러 날 무시한다고 느껴진다.' },
            { id: 21, scale: 'selfcenter', text: '내가 원하는 방식으로 사랑을 표현해주지 않으면 사랑이 아니다.' },
            { id: 22, scale: 'decision', text: '상대가 원하지 않는다고 했는데도 지속적으로 온라인 메시지를 보내거나 연락을 시도한 적이 있다.' },
            { id: 23, scale: 'attachment', text: '상대방이 다른 사람과 함께 있는 모습을 보면 질투가 난다.' },
            { id: 24, scale: 'control', text: '연인의 과거 연애에 대해 자세히 알고 싶어한다.' },
            { id: 25, scale: 'rejection', text: '관심을 보였던 사람이 무심해지면 감정기복이 커진다.' },
            { id: 26, scale: 'selfcenter', text: '나의 감정이 가장 중요하고 우선시되어야 한다.' },
            { id: 27, scale: 'attachment', text: '잠시라도 연락이 안 되면 무슨 일이 생긴 건 아닌지 걱정된다.' },
            { id: 28, scale: 'control', text: '연인이 나 없이 즐거워하는 모습을 보면 서운하다.' },
            { id: 29, scale: 'rejection', text: '누군가가 무심하게 구는 건 내 감정을 무시하는 일처럼 느껴진다.' },
            { id: 30, scale: 'rejection', text: '누군가와 가까워지기 전부터 이미 거절을 두려워한다.' },
            { id: 31, scale: 'check', text: '이 문항은 \'매우 그렇다\'를 선택해주세요.' },
            { id: 32, scale: 'belief', text: '연애 중이라면 위치나 일정 공유는 당연하다고 생각한다.' },
            { id: 33, scale: 'attachment', text: '상대방의 작은 변화도 놓치지 않고 파악한다.' },
            { id: 34, scale: 'control', text: '연인이 내 말을 듣지 않으면 화가 난다.' },
            { id: 35, scale: 'rejection', text: '내가 고백했는데 거절당하면 모욕감이나 분노를 느낀다.' },
            { id: 36, scale: 'attachment', text: '상대방 없이는 하루도 못 살 것 같은 느낌이 든다.' },
            { id: 37, scale: 'control', text: '연인의 친구 관계도 내가 관여해야 한다고 생각한다.' },
            { id: 38, scale: 'control', text: '상대방이 나와 다른 의견을 가지면 설득하려고 한다.' },
            { id: 39, scale: 'belief', text: '내가 하는 행동은 스토킹이 아니라 순수한 애정 표현이라고 생각한다.' },
            { id: 40, scale: 'attachment', text: '헤어진 후에도 그 사람의 소식이 궁금해서 찾아본다.' },
            { id: 41, scale: 'control', text: '연인이 나보다 다른 것을 우선시하면 배신감을 느낀다.' },
            { id: 42, scale: 'rejection', text: '친구나 지인이 나보다 더 잘 지내는 걸 보면 소외감을 느낀다.' },
            { id: 43, scale: 'attachment', text: '상대방의 SNS 활동을 계속 확인하게 된다.' },
            { id: 44, scale: 'rejection', text: '애매하게 거절당하면 스스로 \'찌질하다\'는 생각이 든다.' }
        ];
        
        // 애착 문항
        const attachmentQuestions = [
            '가까운 사람이 나를 떠날까 봐 자주 걱정한다.',
            '다른 사람들과 정서적으로 너무 가까워지는 것이 불편하다.',
            '거절당하면 극도로 불안하거나 화가 난다.',
            '화가 나면 내 감정을 조절하기 어렵다.',
            '충동적으로 행동한 후 후회하는 경우가 많다.',
            '타인의 의도를 부정적으로 해석하는 경향이 있다.',
            '내가 중요하게 생각하는 사람이 나를 소홀히 대하면 심하게 상처받는다.',
            '나는 스트레스 상황에서 건설적인 방식으로 대처하는 편이다.'
        ];
        
        // 문항 생성 함수
        function generateQuestions() {
            const container = document.getElementById('questionsContainer');
            
            questions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.id = `question_${q.id}`;
                questionDiv.innerHTML = `
                    <div class="question-number">문항 ${q.id}</div>
                    <div class="question-text">${q.text}</div>
                    <div class="scale-options">
                        <div class="scale-option">
                            <input type="radio" id="q${q.id}_1" name="q${q.id}" value="1" required>
                            <label for="q${q.id}_1">1</label>
                        </div>
                        <div class="scale-option">
                            <input type="radio" id="q${q.id}_2" name="q${q.id}" value="2" required>
                            <label for="q${q.id}_2">2</label>
                        </div>
                        <div class="scale-option">
                            <input type="radio" id="q${q.id}_3" name="q${q.id}" value="3" required>
                            <label for="q${q.id}_3">3</label>
                        </div>
                        <div class="scale-option">
                            <input type="radio" id="q${q.id}_4" name="q${q.id}" value="4" required>
                            <label for="q${q.id}_4">4</label>
                        </div>
                        <div class="scale-option">
                            <input type="radio" id="q${q.id}_5" name="q${q.id}" value="5" required>
                            <label for="q${q.id}_5">5</label>
                        </div>
                    </div>
                    <div class="scale-labels">
                        <span>전혀 그렇지 않다</span>
                        <span>매우 그렇다</span>
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }
        
        // 애착 문항 생성
        function generateAttachmentQuestions() {
            const container = document.getElementById('attachmentContainer');
            
            attachmentQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.id = `attachment_${index + 1}`;
                questionDiv.innerHTML = `
                    <div class="question-number">심리 문항 ${index + 1}</div>
                    <div class="question-text">${q}</div>
                    <div class="scale-options">
                        <div class="scale-option">
                            <input type="radio" id="att${index + 1}_1" name="att${index + 1}" value="1" required>
                            <label for="att${index + 1}_1">1</label>
                        </div>
                        <div class="scale-option">
                            <input type="radio" id="att${index + 1}_2" name="att${index + 1}" value="2" required>
                            <label for="att${index + 1}_2">2</label>
                        </div>
                        <div class="scale-option">
                            <input type="radio" id="att${index + 1}_3" name="att${index + 1}" value="3" required>
                            <label for="att${index + 1}_3">3</label>
                        </div>
                        <div class="scale-option">
                            <input type="radio" id="att${index + 1}_4" name="att${index + 1}" value="4" required>
                            <label for="att${index + 1}_4">4</label>
                        </div>
                        <div class="scale-option">
                            <input type="radio" id="att${index + 1}_5" name="att${index + 1}" value="5" required>
                            <label for="att${index + 1}_5">5</label>
                        </div>
                    </div>
                    <div class="scale-labels">
                        <span>전혀 그렇지 않다</span>
                        <span>매우 그렇다</span>
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }
        
        // 자동 스크롤 함수
        function scrollToNextElement(currentElementId) {
            const currentElement = document.getElementById(currentElementId);
            if (!currentElement) return;
            
            // 다음 요소 찾기
            let nextElement = currentElement.nextElementSibling;
            
            // 다음 demo-group이나 question을 찾을 때까지 반복
            while (nextElement && 
                   !nextElement.classList.contains('demo-group') && 
                   !nextElement.classList.contains('question') &&
                   nextElement.id !== 'attachmentContainer') {
                nextElement = nextElement.nextElementSibling;
            }
            
            // 현재 섹션의 마지막이면 다음 섹션으로
            if (!nextElement) {
                const currentSection = currentElement.closest('.section');
                const nextSection = currentSection ? currentSection.nextElementSibling : null;
                
                if (nextSection && nextSection.classList.contains('section')) {
                    // 다음 섹션의 첫 번째 입력 요소 찾기
                    nextElement = nextSection.querySelector('.demo-group, .question');
                }
            }
            
            if (nextElement) {
                setTimeout(() => {
                    nextElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }, 500);
            }
        }
        
        // 결과 계산 및 표시
        function calculateResult(e) {
            e.preventDefault();
            
            // 주의점검 문항 확인
            const check1 = document.querySelector('input[name="q16"]:checked');
            const check2 = document.querySelector('input[name="q31"]:checked');
            
            if (!check1 || check1.value !== '1' || !check2 || check2.value !== '5') {
                alert('주의점검 문항에 올바르게 응답해주세요.\n문항 16번은 "전혀 그렇지 않다"를, 문항 31번은 "매우 그렇다"를 선택해주세요.');
                return;
            }
            
            // 점수 계산
            let scores = {
                attachment: 0,
                control: 0,
                rejection: 0,
                selfcenter: 0,
                belief: 0
            };
            
            let decisionCount = 0;
            
            questions.forEach(q => {
                if (q.scale !== 'check' && q.scale !== 'decision') {
                    const answer = document.querySelector(`input[name="q${q.id}"]:checked`);
                    if (answer) {
                        scores[q.scale] += parseInt(answer.value);
                    }
                } else if (q.scale === 'decision') {
                    const answer = document.querySelector(`input[name="q${q.id}"]:checked`);
                    if (answer && parseInt(answer.value) >= 4) {
                        decisionCount++;
                    }
                }
            });
            
            // 총점 계산
            const scaleTotal = scores.attachment + scores.control + scores.rejection + 
                             scores.selfcenter + scores.belief;
            const decisionScore = decisionCount * 5;
            const totalScore = scaleTotal + decisionScore;
            
            // 결과 유형 판정
            let resultType = '';
            let typeClass = '';
            let typeDescription = '';
            
            if (decisionCount > 0 && totalScore >= 158) {
                resultType = '🔴 위험형';
                typeClass = 'type-danger';
                typeDescription = '귀하의 응답 결과, 즉시 주의가 필요한 행동 패턴이 발견되었습니다. 현재의 연애 방식이 상대방에게 부담을 주거나 관계에 부정적 영향을 미칠 가능성이 높습니다. 전문가의 도움을 통해 건강한 관계를 만들어갈 수 있습니다.';
            } else if (decisionCount > 0 && totalScore < 158) {
                resultType = '🟠 경계형';
                typeClass = 'type-warning';
                typeDescription = '일부 우려되는 행동이 있지만, 전반적인 성향은 상대적으로 안정적입니다. 그러나 특정 상황에서 문제가 될 수 있는 행동들이 관찰되므로 주의가 필요합니다.';
            } else if (decisionCount === 0 && totalScore >= 147) {
                resultType = '🟡 주의형';
                typeClass = 'type-caution';
                typeDescription = '경계를 넘는 직접적 행동은 없지만, 내면의 집착 성향이 다소 높게 나타났습니다. 적절한 자기 관리와 성찰을 통해 건강한 연애를 할 수 있습니다.';
            } else {
                resultType = '🟢 안정형';
                typeClass = 'type-safe';
                typeDescription = '매우 건강한 연애 성향을 보이고 있습니다! 상대방을 존중하고 적절한 거리감을 유지하며, 균형잡힌 관계를 형성할 수 있는 능력을 갖추고 있습니다.';
            }
            
            // 마무리 인사말 추가
emailData.closing_message = '당신의 아름답고 건강한 연애를 응원합니다 💝';
            
            // 결과 표시
            const name = document.getElementById('name').value;
            document.getElementById('resultName').textContent = name;
            document.getElementById('resultType').innerHTML = `<span class="${typeClass}">${resultType}</span>`;
            document.getElementById('typeDescription').textContent = typeDescription;
            
            // 척도별 결과
            const scaleDescriptions = {
                attachment: {
                    name: '관계집착성',
                    max: 50,
                    desc: '상대방에 대한 과도한 관심과 확인 욕구를 다루는 척도입니다.',
                    high: '상대방에 대한 관심이 매우 강해요. 때로는 여유를 갖고 거리를 두는 것도 필요해요.',
                    medium: '적당한 관심과 애착을 보여주는 편이에요. 균형감이 좋습니다.',
                    low: '독립적이고 여유로운 연애 스타일이에요. 가끔은 더 적극적인 관심 표현도 좋을 거예요.'
                },
                control: {
                    name: '통제욕구',
                    max: 50,
                    desc: '상대방의 일정, 행동, 관계를 조율하려는 경향입니다.',
                    high: '상대방을 내맘대로 이끌고 싶어하는 성향이 강해요. 상대방의 자율성을 더 존중해보세요.',
                    medium: '적절한 수준에서 연애관계를 이끌어가는 편이에요.',
                    low: '상대방의 자유를 잘 존중하는 편이에요. 때로는 더 적극적으로 자신의 의견을 표현해도 좋아요.'
                },
                rejection: {
                    name: '거절민감성',
                    max: 50,
                    desc: '거절이나 무시에 대한 정서적 반응 민감도를 측정합니다.',
                    high: '거절에 매우 민감하게 반응하는 편이에요. 거절도 자연스러운 일임을 받아들여보세요.',
                    medium: '거절에 대한 반응이 적절한 수준이에요.',
                    low: '거절을 잘 받아들이는 성숙한 모습이에요. 좋은 장점입니다.'
                },
                selfcenter: {
                    name: '자기중심성',
                    max: 25,
                    desc: '연애에서 자신의 시각이나 감정에 집중하는 경향입니다.',
                    high: '자신의 관점에서 상황을 해석하는 경향이 강해요. 상대방 입장에서 생각해보는 연습이 필요해요.',
                    medium: '자신과 상대방의 관점을 적절히 고려하는 편이에요.',
                    low: '상대방을 잘 배려하는 성향이에요. 균형감이 좋습니다.'
                },
                belief: {
                    name: '연애신념',
                    max: 25,
                    desc: '연애에 대한 고정관념 또는 이상화 경향을 측정합니다.',
                    high: '연애에 대한 고정된 생각이 강한 편이에요. 좀 더 유연한 사고가 필요할 수 있어요.',
                    medium: '연애에 대한 생각이 적절한 수준이에요.',
                    low: '연애에 대해 유연하고 개방적인 사고를 갖고 있어요.'
                }
            };
            
            let scaleHTML = '';
            
            for (const [key, score] of Object.entries(scores)) {
                const scale = scaleDescriptions[key];
                const average = score / (scale.max / 5);
                const isCaution = average >= 4.0;
                
                let level, levelDesc;
                if (average >= 4.0) {
                    level = '높음';
                    levelDesc = scale.high;
                } else if (average >= 2.5) {
                    level = '보통';
                    levelDesc = scale.medium;
                } else {
                    level = '낮음';
                    levelDesc = scale.low;
                }
                
                scaleHTML += `
                    <div class="scale-result ${isCaution ? 'caution' : ''}">
                        <strong class="scale-name">${scale.name}${isCaution ? ' ⚠️' : ''}</strong> 
                        (${average.toFixed(1)}점, ${level}): ${scale.desc}
                    </div>
                `;
            }
            
            document.getElementById('scaleResults').innerHTML = scaleHTML;
            
            // 폼 숨기고 결과 표시
            document.getElementById('testForm').style.display = 'none';
            document.getElementById('resultSection').style.display = 'block';
            
            // 스크롤 이동
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // 이메일 입력 확인
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            
            if (email) {
                console.log('이메일 발송 대상:', email);
                       
                
                // 이메일 발송을 위한 상세 데이터 준비
                const emailData = {
                    email: email,
                    name: name,
                    result_type: resultType.replace(/[🔴🟠🟡🟢]/g, '').trim(),
                    result_color: typeClass === 'type-danger' ? '#dc3545' : 
                                 typeClass === 'type-warning' ? '#fd7e14' : 
                                 typeClass === 'type-caution' ? '#ffc107' : '#28a745',
                    type_description: typeDescription
                };

           }      
            if (phone) {
                console.log('경품 추첨 대상:', phone);
            }
                
                // 각 척도별 상세 데이터 추가
                const scaleDetails = {
                    attachment: {
                        caution: {
                            high: '- 하루 SNS 확인은 아침, 저녁 2회로 제한',
                            medium: '- 상대방의 독립적 활동 존중하기',
                            low: '- 때로는 더 적극적인 관심 표현 필요'
                        },
                        method: {
                            high: '- 나만의 독립적 생활 영역 구축하기',
                            medium: '- 현재의 적절한 관심 수준 유지',
                            low: '- 의식적으로 애정 표현 늘리기'
                        },
                        task: {
                            high: '- 매일 2시간 휴대폰 없이 보내기',
                            medium: '- 주 1회 각자 시간 갖기 약속',
                            low: '- 하루 1번은 먼저 안부 묻기'
                        },
                        match: {
                            high: '- 독립적이면서 일관된 애정표현을 하는 사람',
                            medium: '- 연락을 일부러 끊는 밀당형 사람',
                            low: '- 과도한 관심과 애정을 요구하는 사람'
                        }
                    },
                    control: {
                        caution: {
                            high: '- 상대방의 개인 일정 간섭하지 않기',
                            medium: '- 중요한 결정은 함께, 작은 일은 각자',
                            low: '- 때로는 더 적극적으로 의견 제시하기'
                        },
                        method: {
                            high: '- 상대방의 자율성 존중하는 법 배우기',
                            medium: '- 건강한 의사결정 과정 만들기',
                            low: '- 건강한 주도성 기르기'
                        },
                        task: {
                            high: '- 상대방 일정 묻지 않고 하루 보내기',
                            medium: '- 상대방 의견 먼저 묻고 듣기',
                            low: '- 데이트 계획 직접 세워보기'
                        },
                        match: {
                            high: '- 독립적이면서도 소통에 적극적인 사람',
                            medium: '- 모든 것을 의존하려는 사람',
                            low: '- 모든 것을 통제하려는 지배적인 사람'
                        }
                    },
                    rejection: {
                        caution: {
                            high: '- 작은 거절도 관계 종료 신호로 오해하지 않기',
                            medium: '- 거절의 의미를 과대해석하지 않기',
                            low: '- 상대방의 감정 신호를 놓치지 않기'
                        },
                        method: {
                            high: '- 거절도 건강한 관계의 일부임을 알기',
                            medium: '- 거절을 성장의 기회로 받아들이기',
                            low: '- 상대방의 감정을 세심하게 관찰하기'
                        },
                        task: {
                            high: '- 거절당했을 때 "괜찮아" 말하고 넘기기',
                            medium: '- 거절당했을 때 심호흡 3번 하기',
                            low: '- 상대방 표정과 톤 관찰하기'
                        },
                        match: {
                            high: '- 부드럽지만 명확한 의사표현을 하는 사람',
                            medium: '- 너무 자주 거절하는 사람',
                            low: '- 심하게 예민하고 감정적인 사람'
                        }
                    },
                    selfcenter: {
                        caution: {
                            high: '- 대화 중 상대방 이야기 끝까지 듣기',
                            medium: '- 나와 상대방의 욕구 균형 맞추기',
                            low: '- 자신의 욕구와 감정도 표현하기'
                        },
                        method: {
                            high: '- 경청 기술 의식적으로 연습하기',
                            medium: '- 건강한 주고받기 생활화',
                            low: '- 건강한 자기 주장 연습하기'
                        },
                        task: {
                            high: '- 대화 중 상대방 말 요약해서 확인하기',
                            medium: '- 의견 차이 시 중간지점 찾기 연습',
                            low: '- 원하는 것 3가지 적고 상대방에게 전달하기'
                        },
                        match: {
                            high: '- 자기 주장이 명확하면서도 유연한 사람',
                            medium: '- 항상 자기 희생만 하는 사람',
                            low: '- 일방적으로 요구만 하는 사람'
                        }
                    },
                    belief: {
                        caution: {
                            high: '- "연애는 이래야 해" 라는 고정관념 버리기',
                            medium: '- 이상과 현실의 균형 맞추기',
                            low: '- 관계에 대한 최소한의 기대치는 가지기'
                        },
                        method: {
                            high: '- 다양한 사랑의 형태 인정하기',
                            medium: '- 서로의 연애 가치관 공유하기',
                            low: '- 건강한 관계의 기준 세우기'
                        },
                        task: {
                            high: '- 연애 고정관념 3가지 적고 의미를 다시 생각하기',
                            medium: '- 서로의 연애관에 대한 대화 시간 갖기',
                            low: '- 관계에서 중요한 가치 3가지 정하기'
                        },
                        match: {
                            high: '- 관계에 대해 유연하고 성숙한 관점을 가진 사람',
                            medium: '- 지나치게 환상적이거나 비현실적인 사람',
                            low: '- 모든 것을 드라마처럼 만들려는 사람'
                        }
                    }
                };
                
                // 각 척도별 데이터 설정
                for (const [key, score] of Object.entries(scores)) {
                    const scale = scaleDescriptions[key];
                    const average = score / (scale.max / 5);
                    const level = average >= 4.0 ? 'high' : average >= 2.5 ? 'medium' : 'low';
                    const levelText = average >= 4.0 ? '높음' : average >= 2.5 ? '보통' : '낮음';
                    const color = average >= 4.0 ? '#ff6b6b' : '#667eea';
                    
                    emailData[`${key}_score`] = average.toFixed(1);
                    emailData[`${key}_level`] = levelText;
                    emailData[`${key}_color`] = color;
                    emailData[`${key}_desc`] = scale[level];
                    emailData[`${key}_caution`] = scaleDetails[key].caution[level];
                    emailData[`${key}_method`] = scaleDetails[key].method[level];
                    emailData[`${key}_task`] = scaleDetails[key].task[level];
                    emailData[`${key}_match_title`] = level === 'high' ? '당신과 잘 맞는 관계 유형' : 
                                                       level === 'medium' ? '피해야 할 관계 유형' : 
                                                       '주의해야 할 관계 연애 상대';
                    emailData[`${key}_match`] = scaleDetails[key].match[level];
                }
                
                // 추가 조언
                if (typeClass === 'type-danger') {
                    emailData.additional_advice = '전문가의 도움을 받는 것을 강력히 권장합니다. 현재의 패턴이 지속되면 건강한 관계 형성이 어려울 수 있습니다. 상담을 통해 자신의 감정과 행동을 이해하고, 더 나은 관계를 만들어갈 수 있습니다.';
                } else if (typeClass === 'type-warning') {
                    emailData.additional_advice = '특정 상황에서 나타나는 행동 패턴에 주의를 기울이세요. 자기 성찰과 노력을 통해 충분히 개선할 수 있습니다. 필요시 전문가의 조언을 구하는 것도 좋은 방법입니다.';
                } else if (typeClass === 'type-caution') {
                    emailData.additional_advice = '전반적으로 건강한 연애를 할 수 있는 역량을 가지고 있습니다. 다만 일부 영역에서 주의가 필요하니, 제공된 실천 과제를 꾸준히 실행해보세요.';
                } else {
                    emailData.additional_advice = '매우 건강한 연애 성향을 가지고 있습니다! 현재의 긍정적인 태도를 유지하면서, 상대방과 함께 성장하는 아름다운 관계를 만들어가세요.';
                }
                
                // 이메일 발송
                emailjs.send('service_bm4sr1r', 'template_8kvuhuj', emailData)
                    .then(function(response) {
                        console.log('이메일 발송 성공!', response.status, response.text);
                    }, function(error) {
                        console.log('이메일 발송 실패...', error);
                    });
            }

            // Google Sheets로 데이터 전송
const sheetData = {
    // 기본정보
    name: name,
    gender: document.querySelector('input[name="gender"]:checked').value,
    age: document.getElementById('age').value,
    marriage: document.getElementById('marriage').value,
    education: document.getElementById('education').value,
    job: document.getElementById('job').value,
    
    // 연애경험
    loveFreq: document.getElementById('loveFreq').value,
    loveDuration: document.getElementById('loveDuration').value,
    currentStatus: document.getElementById('currentStatus').value,
    meetingMethod: document.getElementById('meetingMethod').value,
    datingApp: document.querySelector('input[name="datingApp"]:checked').value,
    socialMediaCheck: document.getElementById('socialMediaCheck').value,
    contactFreq: document.getElementById('contactFreq').value,
    replyWait: document.getElementById('replyWait').value,
    
    // 44개 문항 응답
    q1: document.querySelector('input[name="q1"]:checked')?.value || '',
    q2: document.querySelector('input[name="q2"]:checked')?.value || '',
    q3: document.querySelector('input[name="q3"]:checked')?.value || '',
    q4: document.querySelector('input[name="q4"]:checked')?.value || '',
    q5: document.querySelector('input[name="q5"]:checked')?.value || '',
    q6: document.querySelector('input[name="q6"]:checked')?.value || '',
    q7: document.querySelector('input[name="q7"]:checked')?.value || '',
    q8: document.querySelector('input[name="q8"]:checked')?.value || '',
    q9: document.querySelector('input[name="q9"]:checked')?.value || '',
    q10: document.querySelector('input[name="q10"]:checked')?.value || '',
    q11: document.querySelector('input[name="q11"]:checked')?.value || '',
    q12: document.querySelector('input[name="q12"]:checked')?.value || '',
    q13: document.querySelector('input[name="q13"]:checked')?.value || '',
    q14: document.querySelector('input[name="q14"]:checked')?.value || '',
    q15: document.querySelector('input[name="q15"]:checked')?.value || '',
    q16: document.querySelector('input[name="q16"]:checked')?.value || '',
    q17: document.querySelector('input[name="q17"]:checked')?.value || '',
    q18: document.querySelector('input[name="q18"]:checked')?.value || '',
    q19: document.querySelector('input[name="q19"]:checked')?.value || '',
    q20: document.querySelector('input[name="q20"]:checked')?.value || '',
    q21: document.querySelector('input[name="q21"]:checked')?.value || '',
    q22: document.querySelector('input[name="q22"]:checked')?.value || '',
    q23: document.querySelector('input[name="q23"]:checked')?.value || '',
    q24: document.querySelector('input[name="q24"]:checked')?.value || '',
    q25: document.querySelector('input[name="q25"]:checked')?.value || '',
    q26: document.querySelector('input[name="q26"]:checked')?.value || '',
    q27: document.querySelector('input[name="q27"]:checked')?.value || '',
    q28: document.querySelector('input[name="q28"]:checked')?.value || '',
    q29: document.querySelector('input[name="q29"]:checked')?.value || '',
    q30: document.querySelector('input[name="q30"]:checked')?.value || '',
    q31: document.querySelector('input[name="q31"]:checked')?.value || '',
    q32: document.querySelector('input[name="q32"]:checked')?.value || '',
    q33: document.querySelector('input[name="q33"]:checked')?.value || '',
    q34: document.querySelector('input[name="q34"]:checked')?.value || '',
    q35: document.querySelector('input[name="q35"]:checked')?.value || '',
    q36: document.querySelector('input[name="q36"]:checked')?.value || '',
    q37: document.querySelector('input[name="q37"]:checked')?.value || '',
    q38: document.querySelector('input[name="q38"]:checked')?.value || '',
    q39: document.querySelector('input[name="q39"]:checked')?.value || '',
    q40: document.querySelector('input[name="q40"]:checked')?.value || '',
    q41: document.querySelector('input[name="q41"]:checked')?.value || '',
    q42: document.querySelector('input[name="q42"]:checked')?.value || '',
    q43: document.querySelector('input[name="q43"]:checked')?.value || '',
    q44: document.querySelector('input[name="q44"]:checked')?.value || '',
    
    // 척도별 점수
    attachment_total: scores.attachment,
    attachment_avg: (scores.attachment / 10).toFixed(1),
    control_total: scores.control,
    control_avg: (scores.control / 10).toFixed(1),
    rejection_total: scores.rejection,
    rejection_avg: (scores.rejection / 10).toFixed(1),
    selfcenter_total: scores.selfcenter,
    selfcenter_avg: (scores.selfcenter / 5).toFixed(1),
    belief_total: scores.belief,
    belief_avg: (scores.belief / 5).toFixed(1),
    
    // 심리스트레스
    stress: document.getElementById('stress').value,
    anxiety: document.getElementById('anxiety').value,
    depression: document.getElementById('depression').value,
    mentalDiagnosis: document.getElementById('mentalDiagnosis').value,
    counseling: document.getElementById('counseling').value,
    psychiatry: document.getElementById('psychiatry').value,
    
    // 애착문항
    att1: document.querySelector('input[name="att1"]:checked')?.value || '',
    att2: document.querySelector('input[name="att2"]:checked')?.value || '',
    att3: document.querySelector('input[name="att3"]:checked')?.value || '',
    att4: document.querySelector('input[name="att4"]:checked')?.value || '',
    att5: document.querySelector('input[name="att5"]:checked')?.value || '',
    att6: document.querySelector('input[name="att6"]:checked')?.value || '',
    att7: document.querySelector('input[name="att7"]:checked')?.value || '',
    att8: document.querySelector('input[name="att8"]:checked')?.value || '',
    
    // 기타
    breakupReason: document.getElementById('breakupReason').value,
    email: email || '',
    phone: phone || '',
    resultType: resultType.replace(/[🔴🟠🟡🟢]/g, '').trim(),
    totalScore: totalScore
};

// Apps Script URL - 여기에 배포 후 받은 URL 넣으세요
const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby-XbRYNrirFS6fp6rYMoEK9T43aZdgR2kqXZ7hmJPxrW0Utbr67gcxlgGAuB8M_jya/exec';

fetch(APPS_SCRIPT_URL, {
    method: 'POST',
    mode: 'no-cors',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify(sheetData)
})
.then(() => console.log('데이터 저장 완료'))
.catch(error => console.error('저장 실패:', error));
            
          
        }
        
        // 초기화
        document.addEventListener('DOMContentLoaded', function() {
            // EmailJS 초기화
            if (typeof emailjs !== 'undefined') {
                emailjs.init("hwVLNkkkcpiH3veyw");
            }
            
            generateQuestions();
            generateAttachmentQuestions();
            
            // 자동 스크롤 이벤트 추가 - 검사 문항 (기존)
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const questionElement = this.closest('.question');
                    if (questionElement && questionElement.id) {
                        scrollToNextElement(questionElement.id);
                    }
                });
            });
            
            // 자동 스크롤 이벤트 추가 - select 박스
            document.querySelectorAll('select').forEach(select => {
                select.addEventListener('change', function() {
                    const parentGroup = this.closest('.demo-group');
                    if (parentGroup && parentGroup.id) {
                        scrollToNextElement(parentGroup.id);
                    }
                });
            });
            
            // 자동 스크롤 이벤트 추가 - demo-group 내의 라디오 버튼
            document.querySelectorAll('.demo-group input[type="radio"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const parentGroup = this.closest('.demo-group');
                    if (parentGroup && parentGroup.id) {
                        scrollToNextElement(parentGroup.id);
                    }
                });
            });
            
            // 폼 제출 이벤트
            document.getElementById('testForm').addEventListener('submit', calculateResult);
        });
    </script>
</body>
</html>
