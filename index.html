<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>연애 성향 검사 간단 결과</title>
    <style>
        body { 
            font-family: "맑은 고딕", sans-serif; 
            padding: 2em; 
            max-width: 700px; 
            margin: auto;
            background-color: #f5f5f5;
        }
        h1 { 
            color: #333366; 
            font-size: 1.8em;
            margin-bottom: 30px;
        }
        .box { 
            border: 1px solid #ccc; 
            padding: 1.5em; 
            margin-top: 2em; 
            border-radius: 10px; 
            background-color: #ffffff; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .highlight { 
            font-weight: bold; 
            color: #cc0000; 
        }
        .scale-block { 
            margin-bottom: 1.2em; 
            padding: 10px 0;
        }
        .scale-name {
            font-weight: bold;
            color: #333366;
        }
        .type-danger { color: #dc3545; }
        .type-warning { color: #fd7e14; }
        .type-caution { color: #ffc107; }
        .type-safe { color: #28a745; }
        
        hr {
            border: none;
            border-top: 1px solid #e0e0e0;
            margin: 20px 0;
        }
        
        h3 {
            color: #333366;
            margin-bottom: 15px;
        }
        
        .warning-box {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 20px;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            color: #666;
        }
    </style>
</head>
<body>
    <h1>📋 연애 성향 검사 간단 결과</h1>
    
    <div id="loading" class="loading">결과를 불러오는 중입니다...</div>
    
    <div class="box" id="resultBox" style="display: none;">
        <p><strong id="userName"></strong>님의 검사 결과는 <span class="highlight" id="resultType"></span>입니다.</p>
        <p>총점: <strong id="totalScore"></strong></p>

        <hr>
        <h3>📊 하위 척도 요약</h3>
        <div id="scaleResults"></div>

        <hr>
        <p>⚠️ 상세 해석과 맞춤 조언은 이메일 입력자에 한해 개별 발송되었습니다.</p>
        <p>결과 리포트를 다시 받고 싶으시면 검사 마지막 페이지에서 이메일을 입력해주세요.</p>
    </div>

    <script>
        // URL 파라미터 가져오기
        function getUrlParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                name: params.get('name') || '검사자',
                att: parseInt(params.get('att')) || 0,
                con: parseInt(params.get('con')) || 0,
                rej: parseInt(params.get('rej')) || 0,
                self: parseInt(params.get('self')) || 0,
                bel: parseInt(params.get('bel')) || 0,
                dec1: parseInt(params.get('dec1')) || 0,
                dec2: parseInt(params.get('dec2')) || 0
            };
        }

        // 척도별 수준 판정
        function getLevel(score, maxScore) {
            const average = (score / maxScore) * 5;
            if (average >= 4.0) return { level: '높음', caution: true };
            else if (average >= 2.5) return { level: '보통', caution: false };
            else return { level: '낮음', caution: false };
        }

        // 결과 표시
        function displayResult() {
            const params = getUrlParams();
            
            // 이름 표시
            document.getElementById('userName').textContent = params.name;
            
            // 총점 계산
            const scaleTotal = params.att + params.con + params.rej + params.self + params.bel;
            const decisionScore = (params.dec1 * 5) + (params.dec2 * 5);
            const totalScore = scaleTotal + decisionScore;
            const hasDecisionItem = params.dec1 > 0 || params.dec2 > 0;
            
            // 결과 유형 판정
            let resultType = '';
            let typeClass = '';
            
            if (hasDecisionItem && totalScore >= 158) {
                resultType = '🔴 위험형';
                typeClass = 'type-danger';
            } else if (hasDecisionItem && totalScore < 158) {
                resultType = '🟠 경계형';
                typeClass = 'type-warning';
            } else if (!hasDecisionItem && totalScore >= 147) {
                resultType = '🟡 주의형';
                typeClass = 'type-caution';
            } else {
                resultType = '🟢 안정형';
                typeClass = 'type-safe';
            }
            
            document.getElementById('resultType').innerHTML = `<span class="${typeClass}">${resultType}</span>`;
            document.getElementById('totalScore').textContent = `${totalScore}점 / 210점`;
            
            // 척도별 결과
            const scales = [
                { name: '관계집착성', score: params.att, max: 50, 
                  desc: {
                    high: '상대방에 대한 과도한 관심과 확인 욕구를 다루는 척도입니다.',
                    medium: '상대방의 일정, 행동, 관계를 조율하려는 경향입니다.',
                    low: '거절이나 무시에 대한 정서적 반응 민감도를 측정합니다.'
                  }
                },
                { name: '통제욕구', score: params.con, max: 50,
                  desc: {
                    high: '상대방의 일정, 행동, 관계를 조율하려는 경향입니다.',
                    medium: '상대방의 일정, 행동, 관계를 조율하려는 경향입니다.',
                    low: '상대방의 일정, 행동, 관계를 조율하려는 경향입니다.'
                  }
                },
                { name: '거절민감성', score: params.rej, max: 50,
                  desc: {
                    high: '거절이나 무시에 대한 정서적 반응 민감도를 측정합니다.',
                    medium: '거절이나 무시에 대한 정서적 반응 민감도를 측정합니다.',
                    low: '거절이나 무시에 대한 정서적 반응 민감도를 측정합니다.'
                  }
                },
                { name: '자기중심성', score: params.self, max: 25,
                  desc: {
                    high: '연애에서 자신의 시각이나 감정에 집중하는 경향입니다.',
                    medium: '연애에서 자신의 시각이나 감정에 집중하는 경향입니다.',
                    low: '연애에서 자신의 시각이나 감정에 집중하는 경향입니다.'
                  }
                },
                { name: '연애신념', score: params.bel, max: 25,
                  desc: {
                    high: '연애에 대한 고정관념 또는 이상화 경향을 측정합니다.',
                    medium: '연애에 대한 고정관념 또는 이상화 경향을 측정합니다.',
                    low: '연애에 대한 고정관념 또는 이상화 경향을 측정합니다.'
                  }
                }
            ];
            
            let scaleHTML = '';
            scales.forEach(scale => {
                const average = (scale.score / scale.max) * 5;
                const levelInfo = getLevel(scale.score, scale.max);
                const cautionMark = levelInfo.caution ? ' ⚠️' : '';
                
                // 항상 동일한 설명 사용 (이미지와 일치하도록)
                const description = scale.name === '관계집착성' ? '상대방에 대한 과도한 관심과 확인 욕구를 다루는 척도입니다.' :
                                  scale.name === '통제욕구' ? '상대방의 일정, 행동, 관계를 조율하려는 경향입니다.' :
                                  scale.name === '거절민감성' ? '거절이나 무시에 대한 정서적 반응 민감도를 측정합니다.' :
                                  scale.name === '자기중심성' ? '연애에서 자신의 시각이나 감정에 집중하는 경향입니다.' :
                                  '연애에 대한 고정관념 또는 이상화 경향을 측정합니다.';
                
                scaleHTML += `
                    <div class="scale-block">
                        <span class="scale-name">${scale.name}${cautionMark}</span> 
                        (${average.toFixed(1)}점, ${levelInfo.level}): ${description}
                    </div>
                `;
            });
            
            document.getElementById('scaleResults').innerHTML = scaleHTML;
            
            // 로딩 숨기고 결과 표시
            document.getElementById('loading').style.display = 'none';
            document.getElementById('resultBox').style.display = 'block';
        }

        // 페이지 로드 시 결과 표시
        window.onload = function() {
            displayResult();
        };
    </script>
</body>
</html>
